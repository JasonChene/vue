<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>vue-router 子路由</title>
  <style>
    body {
      max-width: 800px;
      width: auto;
      margin: 0 auto;
    }
    .home, .news, .profile, .about{
      height: 500px;
      padding: 1em;
      background-color: rgba(153, 0, 255, 0.25);
      box-sizing: border-box;
    }
    .news {
      background-color: #0f9;
    }
    .profile{
      background-color: #369;
    }
    .about{
      background-color: #0ff;
    }

    .router-link {
      margin-bottom: 1em;
    }
    .router-children{
      margin-top: 2em;
      padding: 1em;
      background: rgba(204, 204, 204, 0.3);
    }
    /* 当前路由 active */
    .active, .active:focus {
      color: #fff;
      background-color: forestgreen;
      font-size: 1rem;
      padding: 10px;
      border: none;
      outline: none;
    }
  </style>
</head>
<body>
<section id="app">
  <h1>vue-router 路由</h1>

  <div class="router-link">
    <router-link :to="{path: '/home'}" tag="button">主页</router-link>
    <router-link :to="{path: '/news'}" tag="button">新闻</router-link>
    <router-link :to="{path: '/detail'}" tag="button">详情页</router-link>
  </div>

  <!-- router-view 路由出口，是一个全局组件，路由匹配到的组件将渲染到这里 -->
  <keep-alive>
    <!-- 一级路由 -->
    <router-view></router-view>
  </keep-alive>
</section>


<!-- 子组件 -->
<template id="detail">
  <div class="router-children">
    <h2>哈，被你发现了，看看吧</h2>
    <h3>
      <router-link :to="{path: '/detail/profile'}">个人中心</router-link>
      <router-link :to="{path: '/detail/about'}">关于我</router-link>
    </h3>
    <keep-alive>
      <!-- 二级路由 -->
      <router-view></router-view>
    </keep-alive>
  </div>
</template>


<!-- vue-router 必须放在 vue的后面 -->
<script src="../node_modules/vue/dist/vue.min.js"></script>
<script src="../node_modules/vue-router/dist/vue-router.js"></script>
<script>
  /**
   * 每个组件都会有一个 $router 和 $route 的属性
   * this.$router 有 r 的都是方法，路由实例
   * this.$route  没 r 的都是属性，路由信息对象，和 url参数相关
   */

  // 1 定义路由组件
  let Home = {
    template: `<div class="home">
                <h3>这里是主页</h3><button @click="toNews">去新闻页面</button></div>`,
    methods: {
      toNews() {
        this.$router.push({
          path: '/news'
        }); // 强制路由替换
      }
    }
  };

  let News = {
    template: `<div class="news">
                <h3>新闻这边是新闻</h3><button @click="back">返回</button></div>`,
    methods: {
      back() {
        this.$router.go(-1);
      }
    }
  };

  let Detail = {
    template: '#detail',
  };
  let Profile = {
    template: '<div class="profile">我的作品集</div>',
  };
  let About = {
    template: `<div class="about">关于我</div>`,
  };

  let Page404 = {
    template: `<div><h1><mark>404 Not Found</mark></h1>
               <button @click="tohome">返回首页</button></div>`,
    methods:{
      tohome(){
        this.$router.push('/home');
      }
    }
  }


  // 2 定义路由映射表，配置路径和组件的关系，配置的关系就是页面级组件
  const routes = [
    {path: '', component: Home}, // 默认的路由
    {path: '/home', component: Home},
    {path: '/news', component: News},
    {
      path: '/detail',
      component: Detail,
      // 子路由是个 children 相当于 routes
      children: [ // children中的路径永远不带 /， 如果带 / 表示的是 1级路由
        {
          path: '/',
          redirect: 'about'
        },
        {
          path: 'profile',
          component: Profile
        },
        {
          path: 'about',
          component: About
        }
      ]
    },
    {path: '/*', component: Page404}, // 路径变化，组件也要变化，比如 404， 403
  ];

  // 3 创建 router 实例，然后传入 routes 配置, 引入 vue-router 自带 VueRouter() 类
  const router = new VueRouter({
    routes,
    linkActiveClass: 'active'
  });

  // 4 最后 创建和挂载 router 到根实例上
  let vm = new Vue({
    el: '#app',
    router
  });

</script>
</body>
</html>
