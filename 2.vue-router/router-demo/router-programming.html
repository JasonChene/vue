<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>vue-router 路由</title>
  <style>
    body{
      max-width: 800px;
      width: auto;
      margin: 0 auto;
    }
    .home, .news{
      height: 500px;
      padding: 1em;
      background-color: rgba(153, 0, 255, 0.25);
      box-sizing: border-box;
    }
    .news{ background-color: #0f9; }
    .router-link{
      margin-bottom: 1em;
    }


    /* 当前路由 active */
    .active, .active:focus{
      color: #fff;
      background-color: forestgreen;
      font-size: 1rem;
      padding: 10px;
      border:none;
      outline: none;
    }
  </style>
</head>
<body>
<section id="app">
  <h1>vue-router 路由</h1>
  <!--
  router-link 全局组件，声明式路由
    to 属性指定链接
  <router-link> 默认渲染成一个 <a> 标签
  -->
  <div class="router-link">
    <router-link :to="{path: '/home'}" tag="button">主页</router-link>
    <router-link :to="{path: '/news'}" tag="button">新闻</router-link>
  </div>

  <!-- router-view 路由出口，是一个全局组件，路由匹配到的组件将渲染到这里 -->
  <router-view></router-view>
</section>

<!-- vue-router 必须放在 vue的后面 -->
<script src="../node_modules/vue/dist/vue.min.js"></script>
<script src="../node_modules/vue-router/dist/vue-router.js"></script>
<script>
  /**
   * 每个组件都会有一个 $router 和 $route 的属性
   * this.$router 有 r 的都是方法，路由实例
   * this.$route  没 r 的都是属性，路由信息对象，和 url参数相关
   *  $route.path
   *  $route.params
   *  $route.query
   *  $route.hash
   *  $route.fullPath
   *  $route.matched
   *  $route.name
   */

  // 1 定义路由组件
  let Home = {
    template: `<div class="home">
                <h3>这里是主页</h3><button @click="to-news">去新闻页面</button></div>`,
    methods:{
      'to-news'(){
        this.$router.push('/news'); // 强制路由替换
        // this.$router.replace('/news'); // 路由替换，将当前的历史记录替换掉
        // ['/', '/home', '/news', '/home']  push
        // ['/', '/home', '/news', '/news']  replace
      }
    }
  };

  let News = {
    template: `<div class="news">
                <h3>新闻这边是新闻</h3><button @click="back">返回</button></div>`,
    methods:{
      back(){
        this.$router.go(-1);
      }
    }
  };

  // 2 定义路由映射表，配置路径和组件的关系，配置的关系就是页面级组件
  const routes = [
    // 路径必须加 / 一上来，重定向 home，类似 404，找不到就回到这个页面
    {path: '', component: Home}, // 默认的路由
    {path: '/home', component: Home},
    {path: '/news', component: News},
    // {path: '*', template: News}, // 路径不变，只是切换了组件
    {path: '*', redirect: '/home'}, // 路径变化，组件也要变化，比如 404， 403
  ];

  // 3 创建 router 实例，然后传入 routes 配置, 引入 vue-router 自带 VueRouter() 类
  const router = new VueRouter({
    // mode: 'history',
    routes, // routes: routes
    // 更改默认的 router-link-active
    linkActiveClass: 'active'
  });

  // 4 最后 创建和挂载 router 到根实例上
  let vm = new Vue({
    el: '#app',
    router
  });

</script>
</body>
</html>
